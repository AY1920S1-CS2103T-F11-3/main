@startuml
!include ../style.puml

Class AnalysePasswordCommand LOGIC_COLOR_T1{
--
+execute() : CommandResult
}

Class Password LOGIC_COLOR_T1
    Interface Analyser LOGIC_COLOR_T1 {
    ----
    + analyse(List<Password> p) : List<Result> r
    }
together {
    Class DictionaryAnalyser LOGIC_COLOR_T1

    Class SimilarityAnalyser LOGIC_COLOR_T1

    Class SequenceAnalyser  LOGIC_COLOR_T1

    Class StrengthAnalyser  LOGIC_COLOR_T1

    Class UniqueAnalyser  LOGIC_COLOR_T1
}

Class "{abstract}\nResult" as Result LOGIC_COLOR_T1{
# password : Password
# description : String
---
+ {abstract} getGreaterDetail : String
+ toString() : String
}

together {
    Class DictionaryResult LOGIC_COLOR_T1{
    - matches : List<DictionaryMatch>
    }

    Class SimilarityResult LOGIC_COLOR_T1{
    - matches : List<SimilarityMatch>
    }

    Class SequenceResult LOGIC_COLOR_T1 {
    - matches : List<SequenceMatch>
    }
    Class StrengthResult LOGIC_COLOR_T1

    Class UniqueResult LOGIC_COLOR_T1 {
    - matches : List<UniqueMatch>
    }
}


Class AnalysisReport LOGIC_COLOR_T1{
-reportBuilder : StringBuilder
----
- write(Result r): void
}

AnalysePasswordCommand .> Password : retrieves
AnalysePasswordCommand .down.> Analyser : retrieves

Analyser "*" .right.> "*" Password : analyses
(Analyser, Password) .. Result

DictionaryAnalyser .up.|> Analyser
SimilarityAnalyser .up.|> Analyser
UniqueAnalyser .up.|> Analyser
SequenceAnalyser .up.|> Analyser
StrengthAnalyser .up.|> Analyser
UniqueAnalyser -[hidden]up- SimilarityAnalyser
SequenceAnalyser -[hidden]up UniqueAnalyser
StrengthAnalyser -[hidden]up SequenceAnalyser
SimilarityAnalyser -[hidden]up DictionaryAnalyser

AnalysisReport "1".down.>"*" Result : writes

DictionaryResult  -up-|> Result
SimilarityResult -up-|> Result
SequenceResult  -up-|> Result
UniqueResult -up-|> Result
StrengthResult  -up-|> Result
SimilarityResult -[hidden]up- SequenceResult
UniqueResult -[hidden]up- DictionaryResult
StrengthResult -[hidden]up- DictionaryResult

show members

skinparam classFontColor #000000
skinparam classAttributeIconSize 0
@enduml
